<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üöÄ Productivity Boost Hub</title>
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      --card-bg: rgba(255, 255, 255, 0.05);
      --border: rgba(255, 255, 255, 0.1);
      --accent: #00fff7;
      --accent-2: #9ef5ff;
      --text: #e0f7fa;
      --muted: #b7dfe6;
      --text-glow: 0 0 5px #00fff7;
      --button-bg: #00fff7;
      --button-text: #000;
      --button-glow: 0 0 10px #00fff7;
      --focus: 0 0 0 3px rgba(0, 255, 247, 0.35);
      --radius: 14px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 2rem clamp(1rem, 3vw, 2rem);
      font-family: 'Orbitron', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    h1 {
      font-size: clamp(1.6rem, 2.2rem + 0.5vw, 2.4rem);
      margin: 0 0 1.25rem 0;
      color: var(--accent);
      text-shadow: var(--text-glow);
      letter-spacing: .5px;
      display: flex; align-items: center; gap:.6rem;
      animation: fadeInUp .9s ease-out;
    }

    @keyframes fadeInUp { from { opacity: 0; transform: translateY(16px);} to { opacity: 1; transform: translateY(0);} }

    .topbar { display: grid; gap: .75rem; margin-bottom: 1rem; }

    /* Tabs */
    .tabs { display: flex; gap: .6rem; flex-wrap: wrap; }
    .tab { padding: .55rem .9rem; border-radius: var(--radius); background: var(--card-bg); border: 1px solid var(--border); cursor: pointer; font-weight: 700; transition: 0.2s; }
    .tab.active { background: var(--accent); color: #111; box-shadow: var(--button-glow); border-color: transparent; }

    /* Controls */
    .controls { display: flex; align-items: center; gap: .6rem; flex-wrap: wrap; }
    .btn { background: var(--button-bg); color: var(--button-text); padding: .55rem .9rem; border: none; border-radius: 10px; cursor: pointer; font-weight: 800; box-shadow: var(--button-glow); transition: transform .12s ease; }
    .btn:hover { transform: translateY(-1px); }
    .btn.secondary { background: transparent; color: var(--accent-2); border: 1px solid var(--border); box-shadow: none; }
    .pill { font-size: .95rem; padding:.45rem .7rem; background: var(--card-bg); border:1px solid var(--border); border-radius: 999px; }

    /* Sections */
    .section { display: none; }
    .section.active { display: block; }

    .search { width: 100%; border-radius: 12px; border: 1px solid var(--border); background: var(--card-bg); padding: .7rem .9rem; color: var(--text); outline: none; }
    .search:focus { box-shadow: var(--focus); }

    /* Grid + Cards */
    .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: .8rem; }
    .card { border:1px solid var(--border); background: var(--card-bg); border-radius: var(--radius); padding: .9rem; display:flex; flex-direction:column; gap:.7rem; }
    .card h3 { margin:0; font-size:1rem; color: var(--accent-2); }
    .card p { margin:0; color: var(--muted); font-size:.92rem; min-height: 2.2em; }
    .row { display:flex; gap:.5rem; flex-wrap: wrap; }
    .tool-link, .icon-btn { display:inline-flex; align-items:center; gap:.5rem; text-decoration:none; font-weight:800; border-radius:10px; padding:.45rem .6rem; cursor:pointer; }
    .tool-link { color: var(--accent); border: 1px solid var(--border); background: var(--card-bg); }
    .tool-link:hover { border-color: var(--accent); box-shadow: var(--button-glow); }
    .icon-btn { background: transparent; border:1px solid var(--border); color: var(--text); }
    .icon-btn:hover { border-color: var(--accent); box-shadow: var(--button-glow); }
    .favorite[aria-pressed="true"] { border-color: var(--accent); box-shadow: var(--button-glow); }

    .footer { margin-top: auto; text-align: center; font-size: .9rem; padding: 1rem; color: #b9dfe6; }

    /* Options menu */
    .menu { position: relative; display: inline-block; }
    .menu-btn { background: transparent; border:1px solid var(--border); border-radius:10px; padding:.45rem .6rem; color: var(--text); cursor:pointer; }
    .menu-list { position:absolute; right:0; margin-top:.4rem; min-width:220px; background: var(--card-bg); border:1px solid var(--border); border-radius:12px; padding:.4rem; display:none; z-index:10; }
    .menu.open .menu-list { display:block; }
    .menu-item { padding:.5rem .6rem; border-radius:8px; cursor:pointer; }
    .menu-item:hover { background: rgba(255,255,255,.07); }

    /* Preview drawer */
    .preview { position: fixed; top:0; right:-420px; width:min(420px, 94vw); height:100vh; background:#08161c; border-left:1px solid var(--border); box-shadow: -8px 0 24px rgba(0,0,0,.25); transition:right .22s ease; z-index: 50; display:flex; flex-direction:column; }
    .preview.open { right:0; }
    .preview-header { display:flex; align-items:center; justify-content:space-between; gap:.5rem; padding: .8rem .9rem; border-bottom:1px solid var(--border); }
    .preview-title { font-weight:800; color: var(--accent-2); }
    .preview-body { padding: .9rem; overflow:auto; }
  </style>
</head>
<body>
  <h1>üöÄ Productivity Boost Hub <span class="pill">v2025.08.30</span></h1>

  <div class="topbar">
    <!-- Tabs -->
    <div class="tabs">
      <button class="tab" data-target="reports">üìä Share Reports</button>
      <button class="tab" data-target="guide">üß© Problem Solve Guide</button>
      <button class="tab" data-target="scripts">üß† Tampermonkey Scripts</button>
      <button class="tab" data-target="mastertools">üß∞ MasterTools</button>
    </div>

    <!-- Controls (global) -->
    <div class="controls" id="globalControls">
      <button class="btn" id="emojiToggle">üòé Emojis: ON</button>
      <button class="btn secondary" id="expandAll">Expand all</button>
      <button class="btn" id="refreshBtn">‚Üª Refresh</button>
      <div class="menu" id="optionsMenu">
        <button class="menu-btn" id="optionsBtn">‚ãØ Options</button>
        <div class="menu-list" role="menu" aria-label="Options">
          <div class="menu-item" data-opt="view-cards">View: Cards</div>
          <div class="menu-item" data-opt="view-list">View: List</div>
          <div class="menu-item" data-opt="toggle-preview">Toggle Preview Panel</div>
          <div class="menu-item" data-opt="compact">Compact density</div>
        </div>
      </div>
      <div id="visitInfo" class="pill">üëÅÔ∏è Total Visits: 12,480 (demo)</div>
      <div id="countryStats" class="pill" style="display:none">üá∫üá∏ US 87% ¬∑ üá≤üáΩ MX 7% ¬∑ üåé Others 6% (demo)</div>
    </div>
  </div>

  <!-- REPORTS -->
  <section id="reports" class="section">
    <input type="text" id="reportSearch" class="search" placeholder="üîç Search reports...">
    <div id="reportContainer" class="grid" style="margin-top:.8rem"></div>
    <div id="error" class="error-msg"></div>
  </section>

  <!-- GUIDE -->
  <section id="guide" class="section">
    <input type="text" id="guideSearch" class="search" placeholder="üîç Search guide...">
    <div id="guideContainer" class="grid" style="margin-top:.8rem"></div>
  </section>

  <!-- SCRIPTS -->
  <section id="scripts" class="section">
    <input type="text" id="scriptSearch" class="search" placeholder="üîç Search scripts...">
    <div class="card" style="margin-top:.8rem">
      <p style="margin:.2rem 0 .6rem 0">üìù Want to share your script? Fill the form and it will appear here after review.</p>
      <div class="row">
        <a class="tool-link" href="https://docs.google.com/forms/d/e/1FAIpQLSdVhvhkmE28nIxDH2DAo4FR7W14zqUxp2KlGHvib6baAMplEQ/viewform" target="_blank" rel="noopener">Open Google Form</a>
        <a class="tool-link" href="https://drive.google.com/drive/folders/1Ob9wywyzwtR3ecBAZrYqJxdqDBwbaH0I" target="_blank" rel="noopener">Shared Drive Folder</a>
      </div>
    </div>
    <div id="scriptContainer" class="grid" style="margin-top:.8rem"></div>
  </section>

  <!-- MASTERTOOLS -->
  <section id="mastertools" class="section">
    <input type="text" id="masterSearch" class="search" placeholder="üîç Search MasterTools...">
    <div class="grid" id="masterGrid" style="margin-top:.8rem"></div>
  </section>

  <div class="footer">Created by qjuflore | Juan Flores</div>

  <!-- Preview Drawer -->
  <aside id="preview" class="preview" aria-hidden="true">
    <div class="preview-header">
      <div class="preview-title" id="previewTitle">Preview</div>
      <button class="menu-btn" id="previewClose">‚úï</button>
    </div>
    <div class="preview-body" id="previewBody">Nothing selected.</div>
  </aside>

  <script>
  (function(){
    const $ = (s, r=document)=>r.querySelector(s); const $$=(s, r=document)=>Array.from(r.querySelectorAll(s));

    // ===== Persisted UI state =====
    const LS = {
      tab: 'pb.activeTab',
      emoji: 'pb.emojis',
      favs: 'pb.master.favorites',
      expand: 'pb.expandAll',
      view: 'pb.view', // 'cards' | 'list'
      preview: 'pb.preview', // 'on' | 'off'
      compact: 'pb.compact', // 'on' | 'off'
    };

    const state = {
      get activeTab(){ return localStorage.getItem(LS.tab) || 'reports'; },
      set activeTab(v){ localStorage.setItem(LS.tab, v); },
      get emojis(){ return localStorage.getItem(LS.emoji) !== 'off'; },
      set emojis(f){ localStorage.setItem(LS.emoji, f?'on':'off'); },
      get favorites(){ try { return JSON.parse(localStorage.getItem(LS.favs)||'[]'); } catch { return []; } },
      set favorites(v){ localStorage.setItem(LS.favs, JSON.stringify(v)); },
      get expandAll(){ return localStorage.getItem(LS.expand)==='on'; },
      set expandAll(f){ localStorage.setItem(LS.expand, f?'on':'off'); },
      get view(){ return localStorage.getItem(LS.view) || 'cards'; },
      set view(v){ localStorage.setItem(LS.view, v); },
      get preview(){ return localStorage.getItem(LS.preview) || 'off'; },
      set preview(v){ localStorage.setItem(LS.preview, v); },
      get compact(){ return localStorage.getItem(LS.compact) || 'off'; },
      set compact(v){ localStorage.setItem(LS.compact, v); },
    };

    // ===== Tabs (selection + URL) =====
    function setActiveTab(id){
      $$('.section').forEach(s=>s.classList.toggle('active', s.id===id));
      $$('.tab').forEach(t=>t.classList.toggle('active', t.dataset.target===id));
      state.activeTab=id;
      const url=new URL(location.href); url.searchParams.set('tab', id); url.hash='#'+id; history.replaceState(null,'',url);
      syncOptions();
    }

    $$('.tab').forEach(tab=> tab.addEventListener('click', ()=> setActiveTab(tab.dataset.target)));
    // Initial tab from URL/hash/localStorage
    (function(){ const u=new URL(location.href); const p=u.searchParams.get('tab')||location.hash.replace('#','')||state.activeTab; setActiveTab(p||'reports'); })();

    // ===== Emoji toggle =====
    const emojiBtn=$('#emojiToggle');
    function syncEmoji(){ const on=state.emojis; emojiBtn.textContent= on? 'üòé Emojis: ON':'üôÇ Emojis: OFF'; document.documentElement.classList.toggle('emoji-off',!on);} 
    emojiBtn.addEventListener('click', ()=>{ state.emojis=!state.emojis; syncEmoji(); }); syncEmoji();

    // ===== Expand/Collapse All (per section) =====
    const expandBtn=$('#expandAll');
    function syncExpandBtn(){ expandBtn.textContent= state.expandAll? 'Collapse all':'Expand all'; }
    expandBtn.addEventListener('click', ()=>{ state.expandAll=!state.expandAll; syncExpandBtn(); const sec=$('#'+state.activeTab); $$('.category', sec).forEach(c=>c.classList.toggle('open', state.expandAll)); });
    syncExpandBtn();

    // ===== Options menu (view/list + preview panel + compact) =====
    const menu=$('#optionsMenu'); const menuBtn=$('#optionsBtn'); const menuList=menu.querySelector('.menu-list');
    document.addEventListener('click', (e)=>{ if(menu.contains(e.target)){ menu.classList.toggle('open', e.target===menuBtn ? !menu.classList.contains('open') : true); } else { menu.classList.remove('open'); } });

    function syncOptions(){
      // View mode
      const containers = ['reportContainer','guideContainer','scriptContainer','masterGrid'].map(id=> $('#'+id)).filter(Boolean);
      containers.forEach(el=>{ el.classList.toggle('grid', state.view==='cards'); el.style.display=''; });
      // Preview panel
      $('#preview').classList.toggle('open', state.preview==='on');
      $('#preview').setAttribute('aria-hidden', state.preview==='on' ? 'false':'true');
      // Compact density
      document.body.classList.toggle('compact', state.compact==='on');
    }

    menuList.addEventListener('click', (e)=>{
      const item=e.target.closest('.menu-item'); if(!item) return;
      const opt=item.dataset.opt;
      if(opt==='view-cards') state.view='cards';
      if(opt==='view-list') state.view='list';
      if(opt==='toggle-preview') state.preview= state.preview==='on'?'off':'on';
      if(opt==='compact') state.compact= state.compact==='on'?'off':'on';
      syncOptions(); menu.classList.remove('open');
    });

    // ===== Preview drawer helpers =====
    window.openPreview = function(content, title='Preview'){ $('#previewTitle').textContent=title; $('#previewBody').innerHTML= content || 'Empty'; state.preview='on'; syncOptions(); }
    $('#previewClose').addEventListener('click', ()=>{ state.preview='off'; syncOptions(); });

    // Delegated preview: any element with [data-preview-html]
    document.addEventListener('click', (e)=>{
      const t=e.target.closest('[data-preview-html]'); if(!t) return;
      openPreview(t.getAttribute('data-preview-html'), t.getAttribute('data-preview-title')||'Preview');
    });

    // ===== MasterTools (favorites + cards + search) =====
    const MASTER_DATA=[
      { id:'trailer-plan', icon:'üöõ', name:'Trailer Plan Analyzer', href:'trailer-plan.html', desc:'Plan injection, density & severity attributes for trailers.' },
      // Add more tools here
    ];
    function isFav(id){ return state.favorites.includes(id); }
    function toggleFav(id){ const favs=new Set(state.favorites); favs.has(id)?favs.delete(id):favs.add(id); state.favorites=[...favs]; renderMasterTools(); }
    function toolCard(t){
      const card=document.createElement('div'); card.className='card'; card.dataset.id=t.id;
      card.innerHTML=`<h3>${t.icon} ${t.name}</h3><p>${t.desc||''}</p>
      <div class="row">
        <a class="tool-link" href="${t.href}" target="_blank" rel="noopener">Open</a>
        <button class="icon-btn favorite" aria-pressed="${isFav(t.id)}" title="Favorite">‚òÖ</button>
        <button class="icon-btn copy-btn" title="Copy link">‚ßâ</button>
        <button class="icon-btn" data-preview-html="<iframe src='${t.href}' style='width:100%;height:70vh;border:0;border-radius:12px;'></iframe>" data-preview-title="${t.name} ‚Äî Preview">Preview</button>
      </div>`;
      const favBtn=card.querySelector('.favorite'); favBtn.addEventListener('click', ()=> toggleFav(t.id));
      const copyBtn=card.querySelector('.copy-btn'); copyBtn.addEventListener('click', async ()=>{ try{ const url=new URL(t.href, location.href).href; await navigator.clipboard.writeText(url); const old=copyBtn.textContent; copyBtn.textContent='‚úî'; setTimeout(()=>copyBtn.textContent=old,900);}catch{} });
      return card;
    }
    function renderMasterTools(){ const wrap=$('#masterGrid'); if(!wrap) return; wrap.innerHTML=''; const data=[...MASTER_DATA]; data.sort((a,b)=> (isFav(b.id)-isFav(a.id)) || a.name.localeCompare(b.name)); data.forEach(t=> wrap.appendChild(toolCard(t))); }
    const masterSearch=$('#masterSearch'); if(masterSearch) masterSearch.addEventListener('input', ()=>{ const q=masterSearch.value.trim().toLowerCase(); $$('#masterGrid .card').forEach(c=>{ const txt=c.textContent.toLowerCase(); c.style.display= q? (txt.includes(q)?'':'none') : ''; }); });

    // ===== Stubs (so Refresh works) =====
    window.loadReports=window.loadReports||function(){};
    window.loadGuide=window.loadGuide||function(){};
    window.loadScripts=window.loadScripts||function(){};

    // ===== Refresh (calls section loaders) =====
    $('#refreshBtn').addEventListener('click', ()=>{ const id=state.activeTab; const map={reports:'loadReports', guide:'loadGuide', scripts:'loadScripts', mastertools:'renderMasterTools'}; const fn=window[map[id]]; if(typeof fn==='function') fn(); });

    // ===== Simple contains-filter for generic containers =====
    function attachSearch(input, container){ if(!input||!container) return; input.addEventListener('input', ()=>{ const q=input.value.trim().toLowerCase(); Array.from(container.children).forEach(el=>{ const text=el.textContent.toLowerCase(); el.style.display= q? (text.includes(q)?'':'none'):''; }); }); }

    // ===== Init =====
    renderMasterTools();
    attachSearch($('#reportSearch'), $('#reportContainer'));
    attachSearch($('#guideSearch'), $('#guideContainer'));
    attachSearch($('#scriptSearch'), $('#scriptContainer'));

    // Visit details toggle (demo)
    $('#visitInfo').addEventListener('click', ()=>{ const cs=$('#countryStats'); cs.style.display = cs.style.display==='none'?'inline-flex':'none'; });

  })();
  </script>
</body>
</html>
